(set n 10000000)
(set tabname "a")
(set dbpath "/tmp/db")
(set sympath (format "%/sym" dbpath))
(set gen-tab 
    (fn [x]
        (let p (format "%/%/%/" dbpath (+ 2024.01.01 x) tabname))
        (println "Creating table: %" p)
        (let t (table [OrderId Symbol Price Size Tape Timestamp] 
            (list (take (guid 1000000) n)
                  (take [AAPL GOOG MSFT IBM AMZN FB BABA] n) 
                  (as 'F64 (+ x (til n))) 
                  (take (+ x (til 3)) n)
                  (map (fn [x] (as 'C8 x)) (take (+ x (til 3)) n))
                  (as 'TIMESTAMP (til n)) 
            )
        ))
        (set-splayed p t "/tmp/db/sym")
        (println "Table created")
    )
)

;; (map gen-tab (til 5))

(println "Done.")
;; (exit 0)

;; (set t (get-parted "/tmp/db/" 'a))