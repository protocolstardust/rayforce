(def db-path "/tmp/test_parted_db")
(os:rm db-path)
(def dates [2024.01.01 2024.01.02 2024.01.03])
(each d dates
  (def tbl {Date: d Price: (+ (til 10) (* (- d 2024.01.01) 10.0))})
  (set-parted db-path 'a tbl))
(def t (get-parted db-path 'a))
(println "Test 1: select max Price where Price > 1")
(println (select {from: t s: (max Price) where: (> Price 1)}))
(println "Test 2: select max Price where Price > 15")
(println (select {from: t s: (max Price) where: (> Price 15)}))
(println "Test 3: select sum Price where Price > 5")
(println (select {from: t s: (sum Price) where: (> Price 5)}))
(println "All tests passed!")
